<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gestión de Solicitudes - Auto TEC</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../../static/css/gestion_solicitudes.css">
</head>
<body>
  <aside class="sidebar">
    <h2>Gestión Solicitudes</h2>
    <ul>
      <li><a href="/admin/dashboard"><i class="fas fa-home"></i> Dashboard</a></li>
      <li><a href="/admin/clientes"><i class="fas fa-users"></i> Clientes</a></li>
      <li><a href="/admin/autos"><i class="fas fa-car"></i> Autos</a></li>
      <li><a href="/admin/empleados"><i class="fas fa-user-tie"></i> Empleados</a></li>
      <li><a href="/admin/ventas"><i class="fas fa-dollar-sign"></i> Ventas</a></li>
      <li><a href="/admin/solicitudes" class="active"><i class="fas fa-file-alt"></i> Solicitudes</a></li>
      <li><a href="/admin/reportes"><i class="fas fa-chart-bar"></i> Reportes</a></li>
    </ul>
  </aside>

  <main class="main-content">
    <header>
      <h1><i class="fas fa-file-alt"></i> Gestión de Solicitudes</h1>
      <button class="btn-primary" onclick="abrirModal()">
        <i class="fas fa-plus"></i> Nueva Solicitud
      </button>
    </header>

    <section class="stats">
      <div class="card">
        <h3>Total Solicitudes</h3>
        <p th:text="${totalSolicitudes}">120</p>
      </div>
      <div class="card">
        <h3>Aprobadas</h3>
        <p th:text="${aprobadas}">85</p>
      </div>
      <div class="card">
        <h3>Pendientes</h3>
        <p th:text="${pendientes}">35</p>
      </div>
    </section>

    <section class="table-section">
      <div class="table-header">
        <h2><i class="fas fa-list"></i> Lista de Solicitudes</h2>
        <input type="text" placeholder="Buscar solicitud..." id="searchInput">
      </div>

      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Cliente</th>
            <th>Tipo</th>
            <th>Estado</th>
            <th>Fecha</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody id="solicitudesTable">
          <tr th:each="solicitud : ${solicitudes}">
            <td th:text="${solicitud.id}">001</td>
            <td th:text="${solicitud.cliente.nombre}">Juan Pérez</td>
            <td th:text="${solicitud.tipo}">Financiamiento</td>
            <td th:text="${solicitud.estado}">Pendiente</td>
            <td th:text="${#dates.format(solicitud.fecha, 'dd/MM/yyyy')}">01/10/2025</td>
            <td>
              <button class="btn-success"><i class="fas fa-check"></i></button>
              <button class="btn-danger"><i class="fas fa-trash"></i></button>
            </td>
          </tr>
        </tbody>
      </table>
    </section>
  </main>

  <!-- Modal -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="cerrarModal()">&times;</span>
      <h2>Nueva Solicitud</h2>
      <form th:action="@{/admin/solicitudes/guardar}" method="post">
        <label>Cliente</label>
        <select name="clienteId" required>
          <option th:each="cliente : ${clientes}" th:value="${cliente.id}" th:text="${cliente.nombre}"></option>
        </select>

        <label>Tipo</label>
        <select name="tipo" required>
          <option value="financiamiento">Financiamiento</option>
          <option value="mantenimiento">Mantenimiento</option>
        </select>

        <button type="submit" class="btn-primary">Guardar</button>
      </form>
    </div>
  </div>

  <script src="../../static/javascript/gestion_solicitudes.js"></script>
</body>
</html>
